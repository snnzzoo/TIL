###### 10ì›” 12ì¼

# ğŸš€ ë¡œê·¸ì¸ì— ëŒ€í•œ ì´í•´

### ğŸª HTTP

> Hyper Text Transfer Protocol

- HTML ë¬¸ì„œì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” í”„ë¡œí† ì½œ(ê·œì¹™, ê·œì•½)
- ì›¹(WWW)ì—ì„œ ì´ë£¨ì–´ì§€ëŠ” ëª¨ë“  ë°ì´í„° êµí™˜ì˜ ê¸°ì´ˆ
- í´ë¼ì´ì–¸íŠ¸ - ì„œë²„ í”„ë¡œí† ì½œì´ë¼ê³ ë„ ë¶€ë¦„ 



ğŸŒ› ìš”ì²­ê³¼ ì‘ë‹µ

- ìš”ì²­ (requests)
  - í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ì— ì˜í•´ ì „ì†¡ë˜ëŠ” ë©”ì‹œì§€
- ì‘ë‹µ (response)
  - ì„œë²„ì—ì„œ ì‘ë‹µìœ¼ë¡œ ì „ì†¡ë˜ëŠ” ë©”ì‹œì§€



ğŸŒ› HTTP íŠ¹ì§•

- **ë¹„ì—°ê²°ì§€í–¥(connectionless)**
  - ì„œë²„ëŠ” ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ë³´ë‚¸ í›„ ì—°ê²°ì„ ëŠìŒ
    - ì˜ˆë¥¼ ë“¤ì–´ ìš°ë¦¬ê°€ ë„¤ì´ë²„ ë©”ì¸ í˜ì´ì§€ë¥¼ ë³´ê³  ìˆì„ ë•Œ ìš°ë¦¬ëŠ” ë„¤ì´ë²„ ì„œë²„ì™€ ì—°ê²°ë˜ì–´ ìˆëŠ” ê²ƒì´ ì•„ë‹˜
    - ë„¤ì´ë²„ ì„œë²„ëŠ” ìš°ë¦¬ì—ê²Œ ë©”ì¸ í˜ì´ì§€ë¥¼ ì‘ë‹µí•˜ê³  ì—°ê²°ì„ ëŠì€ ê²ƒ
- **ë¬´ìƒíƒœ(stateless)**
  - ì—°ê²°ì„ ëŠëŠ” ìˆœê°„ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ê°„ì˜ í†µì‹ ì´ ëë‚˜ë©° ìƒíƒœ ì •ë³´ê°€ ìœ ì§€ë˜ì§€ ì•ŠìŒ
  - í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì£¼ê³ ë°›ëŠ” ë©”ì‹œì§€ë“¤ì€ ì„œë¡œ ì™„ì „íˆ ë…ë¦½ì 



> ğŸŒ· ì–´ë–»ê²Œ ë¡œê·¸ì¸ ìƒíƒœë¥¼ ìœ ì§€í• ê¹Œ?
>
> - ìš°ë¦¬ê°€ ë¡œê·¸ì¸ì„ í•˜ê³  ì›¹ ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œ í˜ì´ì§€ë¥¼ ì´ë™í•´ë„ ë¡œê·¸ì¸ â€œìƒíƒœâ€ê°€ ìœ ì§€ë¨
> - ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ ì§€ì†ì ì¸ ìƒíƒœ ìœ ì§€ë¥¼ ìœ„í•´ â€œ**ì¿ í‚¤ì™€ ì„¸ì…˜**â€ì´ ì¡´ì¬



### ğŸª ì¿ í‚¤(Cookie)

ğŸŒ› ê°œë…

- ì„œë²„ê°€ ì‚¬ìš©ìì˜ ì›¹ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ì— ì „ì†¡í•˜ëŠ” ì‘ì€ ë°ì´í„° ì¡°ê°
  - ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ëŠ” ì¿ í‚¤ë¥¼ ë¡œì»¬ì— KEY-VALUEì˜ ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ì €ì¥
  - ë™ì¼í•œ ì„œë²„ì— ì¬ìš”ì²­ ì‹œ ì €ì¥ëœ ì¿ í‚¤ë¥¼ í•¨ê»˜ ì „ì†¡
- ì¿ í‚¤ëŠ” ì„œë¡œ ë‹¤ë¥¸ ìš”ì²­ì´ ë™ì¼í•œ ë¸Œë¼ìš°ì €ë¡œë¶€í„° ë°œìƒí•œ ê²ƒì¸ì§€ íŒë‹¨í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©ë¨
  - ìƒíƒœê°€ ì—†ëŠ”(stateless) HTTPì—ì„œ ìƒíƒœ ì •ë³´ë¥¼ ê´€ë¦¬, ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ ìƒíƒœë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŒ



ğŸŒ› ì¿ í‚¤ ì‚¬ìš© ì˜ˆì‹œ

![image-20221012154922249](README.assets/image-20221012154922249.png)



ğŸŒ› ì¿ í‚¤ ì‚¬ìš© ëª©ì 

- ì„¸ì…˜ ê´€ë¦¬ (Session management)
  - ë¡œê·¸ì¸, ì•„ì´ë”” ìë™ì™„ì„±, ê³µì§€ í•˜ë£¨ ì•ˆ ë³´ê¸°, íŒì—… ì²´í¬, ì¥ë°”êµ¬ë‹ˆ ë“±ì˜ ì •ë³´ ê´€ë¦¬
- ê°œì¸í™” (Personalization)
  - ì‚¬ìš©ì ì„ í˜¸, í…Œë§ˆ ë“±ì˜ ì„¤ì •
- íŠ¸ë˜í‚¹ (Tracking)
  - ì‚¬ìš©ì í–‰ë™ì„ ê¸°ë¡ ë° ë¶„ì„



ğŸŒ› ì„¸ì…˜ (Session)

- ì‚¬ì´íŠ¸ì™€ íŠ¹ì • ë¸Œë¼ìš°ì € ì‚¬ì´ì˜ state(ìƒíƒœ) ë¥¼ ìœ ì§€ì‹œí‚¤ëŠ” ê²ƒ
- í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í•˜ë©´ ì„œë²„ê°€ íŠ¹ì • `session id`ë¥¼ ë°œê¸‰í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ëŠ” `session id`ë¥¼ ì¿ í‚¤ì— ì €ì¥
  - í´ë¼ì´ì–¸íŠ¸ê°€ ë‹¤ì‹œ ë™ì¼í•œ ì„œë²„ì— ì ‘ì†í•˜ë©´ ìš”ì²­ê³¼ í•¨ê»˜ ì¿ í‚¤(`session id`ê°€ ì €ì¥ëœ)ë¥¼ ì„œë²„ì— ì „ë‹¬
  - ì¿ í‚¤ëŠ” ìš”ì²­ ë•Œë§ˆë‹¤ ì„œë²„ì— í•¨ê»˜ ì „ì†¡ ë˜ë¯€ë¡œ ì„œë²„ì—ì„œ `session id`ë¥¼ í™•ì¸í•´ ì•Œë§ì€ ë¡œì§ì„ ì²˜ë¦¬
- `session id`ëŠ” ì„¸ì…˜ì„ êµ¬ë³„í•˜ê¸° ìœ„í•´ í•„ìš”í•˜ë©°, ì¿ í‚¤ì—ëŠ” `session id`ë§Œ ì €ì¥



ğŸŒ› ì¿ í‚¤ Lifetime (ìˆ˜ëª…)

- Session cookie
  - í˜„ì¬ ì„¸ì…˜(current session)ì´ ì¢…ë£Œë˜ë©´ ì‚­ì œë¨
  - ë¸Œë¼ìš°ì € ì¢…ë£Œì™€ í•¨ê»˜ ì„¸ì…˜ì´ ì‚­ì œë¨
- Persistent cookies
  - Expires ì†ì„±ì— ì§€ì •ëœ ë‚ ì§œ í˜¹ì€ Max-Age ì†ì„±ì— ì§€ì •ëœ ê¸°ê°„ì´ ì§€ë‚˜ë©´ ì‚­ì œë¨



ğŸŒ› Session in Django

- DjangoëŠ” database-backed sessions ì €ì¥ ë°©ì‹ì„ ê¸°ë³¸ ê°’ìœ¼ë¡œ ì‚¬ìš©
  - session ì •ë³´ëŠ” Django DBì˜ django_session í…Œì´ë¸”ì— ì €ì¥
  - [ì„¤ì •ì„ í†µí•´ ë‹¤ë¥¸ ì €ì¥ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥](https://docs.djangoproject.com/en/3.2/topics/http/sessions/)
- DjangoëŠ” íŠ¹ì • session idë¥¼ í¬í•¨í•˜ëŠ” ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ê°ê°ì˜ ë¸Œë¼ìš°ì €ì™€ ì‚¬ì´íŠ¸ê°€ ì—°ê²°ëœ sessionì„ í™•ì¸í•¨



## ğŸŒŒ Login

## ğŸª [AuthenticationForm](https://docs.djangoproject.com/en/4.1/topics/auth/default/#django.contrib.auth.forms.AuthenticationForm)

> ë¡œê·¸ì¸ì„ ìœ„í•œ built-in form
>
> - ë¡œê·¸ì¸ í•˜ê³ ì í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ë¥¼ ì…ë ¥ ë°›ìŒ(username, password)
> - ModelFormì´ ì•„ë‹Œ ì¼ë°˜ Formì„ ìƒì† ë°›ê³  ìˆìœ¼ë©°, requestë¥¼ ì²«ë²ˆì§¸ ì¸ìë¡œ ì·¨í•¨



##### accounts / urls.py

```python
# accounts/urls.py

from django.urls import path
from . import views


app_name = 'accounts'
urlpatterns = [
    path('login/', views.login, name='login'),
]
```



##### accounts / views.py

```python
# accounts/views.py

from django.contrib.auth.forms import AuthenticationForm


def login(request):
    if request.method == 'POST':
        pass
    else:
        form = AuthenticationForm()
    context = {
        'form': form
    }
    return render(request, 'accounts/login.html', context)
```



##### accounts / login.html

```django
<!-- accounts/login.html -->

{% extends 'base.html' %}

{% block content %}
  <h1>ë¡œê·¸ì¸</h1>
  <form action="{% url 'accounts:login' %}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit">
  </form>
{% endblock content %}
```



ğŸŒ› [login()](https://docs.djangoproject.com/en/3.2/topics/auth/default/#how-to-log-a-user-in)

- `login(request, user, backend=None)`
- ì¸ì¦ëœ ì‚¬ìš©ìë¥¼ ë¡œê·¸ì¸
  - ìœ ì €ì˜ IDë¥¼ ì„¸ì…˜ì— ì €ì¥í•˜ì—¬ ì„¸ì…˜ì„ ê¸°ë¡
- HttpRequest ê°ì²´ì™€ User ê°ì²´ê°€ í•„ìš”
  - ìœ ì € ì •ë³´ëŠ” ë°˜ë“œì‹œ ì¸ì¦ëœ ìœ ì € ì •ë³´ì—¬ì•¼ í•¨
    - authenticate()í•¨ìˆ˜ë¥¼ í™œìš©í•œ ì¸ì¦
    - AuthenticationFormì„ í™œìš©í•œ is_valid



ğŸª ë¡œê·¸ì¸ ë¡œì§ ì‘ì„±

- ì¼ë°˜ì ì¸ ModelForm ê¸°ë°˜ì˜ Create ë¡œì§ê³¼ ë™ì¼í•˜ì§€ë§Œ,
  - ModelFormì´ ì•„ë‹Œ Formìœ¼ë¡œ í•„ìˆ˜ ì¸ì êµ¬ì„±ì´ ë‹¤ë¦„
  - DBì— ì €ì¥í•˜ëŠ” ê²ƒ ëŒ€ì‹  ì„¸ì…˜ì— ìœ ì €ë¥¼ ê¸°ë¡í•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œí•¨
    - View í•¨ìˆ˜ì™€ ì´ë¦„ì´ ë™ì¼í•˜ì—¬ ë³€ê²½í•˜ì—¬ í˜¸ì¶œ
    - ë¡œê·¸ì¸ URLì´ â€˜/accounts/login/â€™ì—ì„œ ë³€ê²½ë˜ëŠ” ê²½ìš° settings.py LOGIN_URLì„ ë³€ê²½í•˜ì—¬ì•¼ í•¨

```python
from django.contrib.auth import login as auth_login

def login(request):
    if request.method == 'POST':
        form = AuthenticationForm(request, data=request.POST)
        if form.is_valid():
            auth_login(request, form.get_user())
            return redirect('articles:index')
    else:
        form = AuthenticationForm()
    context = {
        'form': form
    }
    return render(request, 'accounts/login.html', context)
```



ğŸŒ› [get_user()](https://github.com/django/django/blob/main/django/contrib/auth/forms.py#L244)

- AuthenticationFormì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ
- ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í–ˆì„ ê²½ìš° ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ê°ì²´ë¥¼ ë°˜í™˜



ğŸª ì„¸ì…˜ ë°ì´í„° í™•ì¸í•˜ê¸°

- ë¡œê·¸ì¸ í›„ ê°œë°œì ë„êµ¬ì™€ DBì—ì„œ djangoë¡œë¶€í„° ë°œê¸‰ë°›ì€ ì„¸ì…˜ í™•ì¸ (ë¡œê·¸ì¸ì€ ê´€ë¦¬ì ê³„ì •ì„ ë§Œë“  í›„ ì§„í–‰)
- django_session í…Œì´ë¸”ì—ì„œ í™•ì¸

![image-20221012161244564](README.assets/image-20221012161244564.png)



ğŸª ì„¸ì…˜ ë°ì´í„° í™•ì¸í•˜ê¸°

- ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
  - ê°œë°œìë„êµ¬ â€“ Application - Cookies

![image-20221012161630322](README.assets/image-20221012161630322.png)



ğŸª ë¡œê·¸ì¸ ë§í¬ ì‘ì„±

- ì‹¤ìŠµ í¸ì˜ë¥¼ ìœ„í•´ base í…œí”Œë¦¿ì— ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” í•˜ì´í¼ ë§í¬ ì‘ì„±

```django
<!-- base.html -->

<body>
  <div class="container">
    <a href="{% url 'accounts:login' %}">Login</a>
    <hr>
    {% block content %}
    {% endblock content %}
  </div>
  ...
</body>
</html>
```



## ğŸŒŒ Authentication with User

ğŸª í˜„ì¬ ë¡œê·¸ì¸ ë˜ì–´ìˆëŠ” ìœ ì € ì •ë³´ ì¶œë ¥í•˜ê¸°

- í…œí”Œë¦¿ì—ì„œ ì¸ì¦ ê´€ë ¨ ë°ì´í„°ë¥¼ ì¶œë ¥í•˜ëŠ” ë°©ë²•

```django
<!-- base.html -->
<body>
  <div class="container">
    <h3>Hello, {{ user }}</h3>
    <a href="{% url 'accounts:login' %}">Login</a>
    <hr>
    {% block content %}
    {% endblock content %}
  </div>
  ...
</body>
</html>
```

> ğŸŒ· ì–´ë–»ê²Œ base í…œí”Œë¦¿ì—ì„œ context ë°ì´í„° ì—†ì´ user ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê±¸ê¹Œ?
>
> - settings.pyì˜ context processors ì„¤ì •ì˜ â€˜django.contrib.auth.context_processors.authâ€™



ğŸª [context processors](https://docs.djangoproject.com/en/3.2/ref/templates/api/#built-in-template-context-processors)

- í…œí”Œë¦¿ì´ ë Œë”ë§ ë  ë•Œ í˜¸ì¶œ ê°€ëŠ¥í•œ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„° ëª©ë¡
- ì‘ì„±ëœ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í…œí”Œë¦¿ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜ë¡œ í¬í•¨ë¨
- ì¦‰, djangoì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ëª©ë¡ì„ ë¯¸ë¦¬ í…œí”Œë¦¿ì— ë¡œë“œ í•´ ë‘” ê²ƒ

```python
# settings.py

TEMPLATES = [
    {
        ...
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```



ğŸŒ› django.contrib.auth.context_processors.auth

- í…œí”Œë¦¿ ë³€ìˆ˜ {{ user }}
  - í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œê·¸ì¸í•œ ê²½ìš° User í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤
  - í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° AnonymousUser í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤

![image-20221012162318745](README.assets/image-20221012162318745.png)



## ğŸŒŒ Logout

ğŸŒ› [logout()](https://docs.djangoproject.com/en/3.2/topics/auth/default/#how-to-log-a-user-out)

- logout(request)
- ìš”ì²­ ìœ ì €ì— ëŒ€í•œ ì„¸ì…˜ ì •ë³´ë¥¼ ì‚­ì œí•¨
  - DBì—ì„œ session data ì‚­ì œ
  - í´ë¼ì´ì–¸íŠ¸ì˜ ì¿ í‚¤ì—ì„œ sessionid ì‚­ì œ
- HttpRequest ê°ì²´ë¥¼ ì¸ìë¡œ ë°›ê³  ë°˜í™˜ ê°’ì´ ì—†ìŒ
- ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•ŠìŒ



##### accounts / urls.py

```python
# accounts/urls.py

from django.urls import path
from . import views


app_name = 'accounts'

urlpatterns = [
    path('login/', views.login, name='login'),
    path('logout/', views.logout, name='logout'),
]
```



##### accounts / views.py

```python
# accounts/views.py

from django.contrib.auth import logout as auth_logout


def logout(request):
    auth_logout(request)
    return redirect('articles:index')
```



##### base.html

```django
<!-- base.html -->

<body>
  <div class="container">
    <h3>Hello, {{ user }}</h3>
    <a href="{% url 'accounts:login' %}">Login</a>
    <form action="{% url 'accounts:logout' %}" method="POST">
      {% csrf_token %}
      <input type="submit" value="Logout">
    </form>
    <hr>
    {% block content %}
    {% endblock content %}
  </div>
</body>
```



ğŸª ë¡œê·¸ì•„ì›ƒ ì¶œë ¥ í™•ì¸ ë° í…ŒìŠ¤íŠ¸

![image-20221012163117108](README.assets/image-20221012163117108.png)



## ğŸŒŒ Limiting access to logged-in users

ğŸª ê°œìš”

- ë¡œê·¸ì¸ ì‚¬ìš©ìì— ëŒ€í•œ ì ‘ê·¼ ì œí•œí•˜ê¸°
- ë¡œê·¸ì¸ ì‚¬ìš©ìì— ëŒ€í•´ ì ‘ê·¼ì„ ì œí•œí•˜ëŠ” 2ê°€ì§€ ë°©ë²•
  - is_authenticated attributeë¥¼ í™œìš©í•œ ì¡°ê±´ë¬¸
  - The login_required decoratorë¥¼ í™œìš©í•œ view ì œí•œ



##### ğŸŒ› **is_authenticated**

- User modelì˜ ì†ì„±(attributes) ì¤‘ í•˜ë‚˜
- ì‚¬ìš©ìê°€ ì¸ì¦ ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ë°©ë²•
- ëª¨ë“  User ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ í•­ìƒ Trueì¸ ì½ê¸° ì „ìš© ì†ì„±
  - AnonymousUserì— ëŒ€í•´ì„œëŠ” í•­ìƒ False
- ì¼ë°˜ì ìœ¼ë¡œ request.userì—ì„œ ì´ ì†ì„±ì„ ì‚¬ìš© (request.user.is_authenticated)
- ê¶Œí•œ(permission)ê³¼ëŠ” ê´€ë ¨ì´ ì—†ìœ¼ë©°, ì‚¬ìš©ìê°€ í™œì„±í™” ìƒíƒœ(active)ì´ê±°ë‚˜ ìœ íš¨í•œ ì„¸ì…˜(valid session)ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ë„ í™•ì¸í•˜ì§€ ì•ŠìŒ



ğŸŒ· [ì°¸ê³ ] [is_authenticated ì½”ë“œ ì‚´í´ë³´ê¸°](https://github.com/django/django/blob/main/django/contrib/auth/base_user.py#L56)

```python
class AbstractBaseUser(models.Model):
    ...
    def is_authenticated(self):
        """
        Always return True. This is a way to tell if the user has been
        authenticated in templates.
        """
        return True
```



ğŸª is_authenticated ì ìš©í•˜ê¸°

- ë¡œê·¸ì¸ê³¼ ë¹„ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ì¶œë ¥ë˜ëŠ” ë§í¬ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì •í•˜ê¸°

```django
<!-- base.html -->

{% if request.user.is_authenticated %}
  <h3>Hello, {{ user }}</h3>
  <form action="{% url 'accounts:logout' %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Logout">
  </form>
  <a href="{% url 'accounts:update' %}">íšŒì›ì •ë³´ìˆ˜ì •</a>
  <form action="{% url 'accounts:delete' %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="íšŒì›íƒˆí‡´">
  </form>
{% else %}
  <a href="{% url 'accounts:login' %}">Login</a>
  <a href="{% url 'accounts:signup' %}">Signup</a>
{% endif %}
```



- ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ê²Œì‹œê¸€ ì‘ì„± ë§í¬ë¥¼ ë³¼ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•˜ê¸°

  - URLì„ ì§ì ‘ ì…ë ¥í•˜ë©´ ê²Œì‹œê¸€ ì‘ì„± í˜ì´ì§€ë¡œ ê°ˆ ìˆ˜ ìˆìŒ â¡ Viewì—ì„œì˜ ì²˜ë¦¬ë„ ë°˜ë“œì‹œ í•„ìš”í•¨


```django
<!-- articles/index.html -->

{% extends 'base.html' %}

{% block content %}
  <h1>Articles</h1>
  {% if request.user.is_authenticated %}
    <a href="{% url 'articles:create' %}">CREATE</a>
  {% else %}
    <a href="{% url 'accounts:login' %}">ìƒˆ ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ ë¡œê·¸ì¸í•˜ì„¸ìš”</a>
  {% endif %}
  ...
{% endblock content %}
```



- ì¸ì¦ëœ ì‚¬ìš©ìë¼ë©´ ë¡œê·¸ì¸ ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë„ë¡ ì²˜ë¦¬

```python
# accounts/views.py

def login(request):
    if request.user.is_authenticated:
        return redirect('articles:index')
    ...
```



##### ğŸŒ› login_required

- login_required decorator
  - ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ë˜ì–´ ìˆìœ¼ë©´ ì •ìƒì ìœ¼ë¡œ view í•¨ìˆ˜ë¥¼ ì‹¤í–‰
  - ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìì˜ ê²½ìš° settings.pyì˜ LOGIN_URL ë¬¸ìì—´ ì£¼ì†Œë¡œ redirect
    - [ì°¸ê³ ] LOGIN_URLì˜ ê¸°ë³¸ ê°’ì€ /accounts/login/



- ë¡œê·¸ì¸ ìƒíƒœì—ì„œë§Œ ê¸€ì„ ì‘ì„±/ìˆ˜ì •/ì‚­ì œ í•  ìˆ˜ ìˆë„ë¡ ë³€ê²½

```python
# accounts/views.py

from django.contrib.auth.decorators import login_required

@login_required
def create(request):
    pass

@login_required
def delete(request, pk):
    pass

@login_required
def update(request, pk):
    pass
```



ğŸª login_required ì ìš© í™•ì¸í•˜ê¸°

- /articles/create/ë¡œ ë¸Œë¼ìš°ì €ì— ì§ì ‘ ìš”ì²­
- ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë° URL í™•ì¸
  - ì¸ì¦ ì„±ê³µ ì‹œ ì‚¬ìš©ìê°€ redirect ë˜ì–´ì•¼í•˜ëŠ” ê²½ë¡œëŠ” "next"ë¼ëŠ” ì¿¼ë¦¬ ë¬¸ìì—´ ë§¤ê°œ ë³€ìˆ˜ì— ì €ì¥ë¨
    - ì˜ˆì‹œ) /accounts/login/?next=/articles/create/



ğŸŒ› "next" query string parameter ëŒ€ì‘

```python
# accounts/views.py

def login(request):
    if request.user.is_authenticated:
        return redirect('articles:index')

    if request.method == 'POST':
        form = AuthenticationForm(request, request.POST)
        if form.is_valid():
            auth_login(request, form.get_user())
            return redirect(request.GET.get('next') or 'articles:index')
...
```



ğŸŒ› "next" query string parameter ì£¼ì˜ì‚¬í•­

- ë§Œì•½ login í…œí”Œë¦¿ì—ì„œ form actionì´ ì‘ì„±ë˜ì–´ ìˆë‹¤ë©´ ë™ì‘í•˜ì§€ ì•ŠìŒ
- í•´ë‹¹ action ì£¼ì†Œ next íŒŒë¼ë¯¸í„°ê°€ ì‘ì„± ë˜ì–´ìˆëŠ” í˜„ì¬ urlì´ ì•„ë‹Œ /accounts/login/ ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ê¸° ë•Œë¬¸

```django
<!-- accounts/login.html -->

{% block content %}
<h1>ë¡œê·¸ì¸</h1>
<form action="" method="POST">
  {% csrf_token %}
  {{ form.as_p }}
  <input type="submit">
</form>
{% endblock content %}
```

> \<form action="{% url 'accounts:login' %}" method="POST">
>
> - actionì´ ë¹„ì–´ ìˆì–´ì•¼ í•œë‹¤!

